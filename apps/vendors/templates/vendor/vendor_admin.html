{% extends 'index.html' %}
{% load static %}
{% load i18n %}
{% block title %}{% trans 'Vendor admin' %}{% endblock %}
{% block content%}
    <div class="box">
        <h1> Vendor admin -{{ vendor.nom }}</h1>
        <strong>My balance :</strong> {{ vendor.get_balance }} FCFA<br>
         <strong>My paid amount: </strong> {{ vendor.get_paid_amount }} FCFA
        <hr>
        <a href="{% url 'edit_vendor' %}"class="button is-info is-uppercase">Edit</a>
        <a href="{% url 'logout' %}" class="btn-danger"> Log out </a>
    </div>
    <div class="box">
        <h2 class="is-size-3 mb-4">My products</h2>
        <a href="{% url 'add_product' %}" class="btn-success is-uppercase mb-6" >Add new product</a>
        {% if products %}
            <table class="table is-fullwidth">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pro in products %}
                        <tr>
                            <td>
                                <a href="{% url 'product' pro.category.slug pro.slug %}}"></a> {{ pro.title }}
                            </td>
                            <td>
                                {{ pro.price }}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p> You don't have any product yet...</p>
        {% endif %}
    </div>

      <div class="box">
        <h2 class="is-size-3 mb-4">My orders</h2>

    {% if orders %}
        {% for order in orders %}
            <div class="{% if order.fully_paid %}has-background-success-light{% else %}has-background-Info-light{% endif %}mb-2 p-4">
                <div class="columns is-multiline">
                    <div class="column is-6">
                        <h3 class="is-size-4">{{ order.id }}-{{ order.nom }} {{ order.prenom }}</h3>
                    </div>
                    <div class="column is-12">
                        <b>Nom:</b>{{ order.nom }} {{ order.prenom }}
                         <b>Address:</b>{{ order.address }}
                        <b>Zip and place:</b>{{ order.zipcode }} {{ order.place }}
                        <b>Email:</b>{{ order.email }}
                         <b>Email:</b>{{ order.phone }}
                        <table class="table is-fullwidth mt-4">
                            <thead>
                                <tr>
                                    <th>Title</th>
                                    <th>Price</th>
                                    <th>Paid</th>
                                    <th>Total</th>
                                </tr>

                            </thead>
                            <tbody>
                            {% for item in order.items.all %}
                                {%  if item.vendor == request.user.vendor %}
                                    <tr>
                                        <td>{{ item.product.title }}</td>
                                        <td>{{ item.product.price }}</td>
                                        <td>{{ item.quantity }}</td>
                                        <td>{{ item.vendor_paid|yesno:"Yes,No" }}</td>
                                        <td>{{ item.get_total_price }} FCFA</td>
                                    </tr>
                                {% endif %}
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>}
            </div>
        {% endfor %}
    {% endif %}
        <a href="{% url 'add_product' %}" class="btn-success is-uppercase mb-6" >Add new product</a>
        {% if products %}
            <table class="table is-fullwidth">
                <thead>
                    <tr>
                        <th>Title</th>
                        <th>Price</th>
                    </tr>
                </thead>
                <tbody>
                    {% for pro in products %}
                        <tr>
                            <td>
                                <a href="{% url 'product' pro.category.slug pro.slug %}}"></a> {{ pro.title }}
                            </td>
                            <td>
                                {{ pro.price }}
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <p> You don't have any product yet...</p>
        {% endif %}
    </div>
{% endblock %}